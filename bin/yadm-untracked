#!/usr/bin/env bash

cd ~

# Create your config here...

# This is a list of dirs/files to find files that are in `yadm list`
find_existing_recursively=(
    bin
    .config
    .vim
)

# As above but don't search recursively
find_existing_nonrecursively=(
    .
)

# A list of dirs/files that will be ignored if not found in `yadm list`
ignore_files_and_dirs=(
    .CFUserTextEncoding
    .DS_Store
    .config/nvim/plugin/packer_compiled.lua
    .config/gh
    .config/git/gitconfig.private
    .vim/autoload/plug.vim
)


# Code, don't change from this point
find_list=$(mktemp -t find_list)
find ${find_existing_recursively[*]} -type f >$find_list
find ${find_existing_nonrecursively[*]} -maxdepth 1 -type f | awk '{sub("^./",""); print}' >>$find_list
sort -o $find_list $find_list

yadm_list=$(mktemp -t yadm_list)
yadm list >$yadm_list
find ${ignore_files_and_dirs[*]} -type f >>$yadm_list
sort -o $yadm_list $yadm_list

# Find the files not in `yadm list`
comm -23 $find_list $yadm_list

rm -f $find_list $yadm_list
